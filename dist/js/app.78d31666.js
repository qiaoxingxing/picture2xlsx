(function(e){function t(t){for(var o,i,c=t[0],u=t[1],l=t[2],d=0,s=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&s.push(r[i][0]),r[i]=0;for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(e[o]=u[o]);f&&f(t);while(s.length)s.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,c=1;c<n.length;c++){var u=n[c];0!==r[u]&&(o=!1)}o&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},r={app:0},a=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var f=u;a.push([1,"chunk-vendors"]),n()})({0:function(e,t){},"034f":function(e,t,n){"use strict";var o=n("85ec"),r=n.n(o);r.a},1:function(e,t,n){e.exports=n("56d7")},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},15:function(e,t){},16:function(e,t){},17:function(e,t){},18:function(e,t){},2:function(e,t){},"22f2":function(e,t,n){e.exports=n.p+"img/downloadxls.3e960483.jpg"},3:function(e,t){},4:function(e,t){},"40a3":function(e,t,n){e.exports=n.p+"img/upload.7b9e71a3.jpg"},5:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("p",[e._v("1. 选择图片")]),o("img",{attrs:{alt:"image",src:n("40a3"),id:"img"},on:{click:e.uploadImage}}),o("p",[e._v("2.下载XLSX")]),o("img",{attrs:{alt:"image",src:n("22f2"),id:"download"},on:{click:e.downloadXlsx}}),o("p"),o("input",{staticStyle:{display:"none"},attrs:{type:"file",name:"file",accept:"image/*",id:"file"},on:{change:e.fileChange}}),e._m(0)])},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"comment"}},[n("br"),n("br"),n("p",[e._v("几点说明")]),n("ul",[n("li",[e._v("图片不会被上传到网络")]),n("li",[e._v("转换后的xlsx大小限制在200*200以下")]),n("li",[e._v("源码地址:")])])])}],i=(n("c975"),n("cb29"),n("c19f"),n("d3b7"),n("25f0"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("2909")),c=n("1146"),u=n.n(c),l=n("1088"),f=n.n(l),d=n("21a6"),s=function(e,t,n){var o=t*(4*n)+4*e;return[o,o+1,o+2,o+3]},p=function(e,t,n){var o=s(e,t,n.width),r=n.data;return[r[o[0]],r[o[1]],r[o[2]],r[o[3]]]};function g(e){var t=e.toString(16);return 1==t.length?"0"+t:t}var v=function(e,t,n){return g(e)+g(t)+g(n)};function h(e){var t=e.width,n=e.height,o=u.a.utils.book_new(),r=u.a.utils.aoa_to_sheet([]);u.a.utils.book_append_sheet(o,r,"sheet_name");for(var a=20,c=[{wpx:a}],l=0;l<t;l++)c.push(c[0]);r["!cols"]=c;for(var s=a,g=[{hpx:s}],h=0;h<n;h++)g.push(g[0]);r["!rows "]=g;var b=new Array(t).fill(""),y=new Array(n).fill(b);u.a.utils.sheet_add_aoa(r,y,{origin:"A1"});for(var w=0;w<n;w++)for(var _=w,x=0;x<t;x++){var j=x,O=u.a.utils.encode_cell({c:x,r:w}),k=r[O],S=p(j,_,e),I=v.apply(void 0,Object(i["a"])(S));k.s={fill:{fgColor:{rgb:I}}}}var A={bookType:"xlsx",bookSST:!1,type:"binary"},E=f.a.write(o,A);Object(d["saveAs"])(new Blob([m(E)],{type:""}),"out.xlsx"),console.debug("done")}function m(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),o=0;o!=e.length;++o)n[o]=255&e.charCodeAt(o);return t}var b={download:h},y={name:"App",data:function(){return{fullscreenLoading:!1}},methods:{test:function(){},downloadXlsx:function(){var e=this,t=this.$loading({lock:!0,text:"处理中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout((function(){try{var n=document.getElementById("img"),o=document.createElement("canvas"),r=e.getScale(n.width,n.height),a=n.width*r,i=n.height*r;o.width=a,o.height=i;var c=o.getContext("2d");c.drawImage(n,0,0,a,i);var u=c.getImageData(0,0,a,i);console.debug("imageData",u),b.download(u),t.close()}catch(l){t.close(),console.debug("error",l),e.$message.error("出现错误")}}),100)},getScale:function(e,t){var n=200,o=Math.max(e,t);return o>n?n/o:1},uploadImage:function(){document.getElementById("file").click()},fileChange:function(){this.loadImage()},loadImage:function(){try{if(document.getElementById("file").files.length<0)return;var e=document.getElementById("file").files[0],t=e.type;if(t=t.substring(0,t.indexOf("/")),"image"!=t)return void this.$message.error("请选择一个jpg|gif|png 格式图片");var n=new FileReader;n.onload=function(e){var t=e.target.result;document.getElementById("img").src=t},n.readAsDataURL(e)}catch(o){console.log(o)}}}},w=y,_=(n("034f"),n("2877")),x=Object(_["a"])(w,r,a,!1,null,null,null),j=x.exports,O=n("5c96");n("0fae");o["default"].use(O["Loading"].directive),o["default"].prototype.$loading=O["Loading"].service,o["default"].prototype.$message=O["Message"],o["default"].config.productionTip=!1,new o["default"]({render:function(e){return e(j)}}).$mount("#app")},6:function(e,t){},7:function(e,t){},8:function(e,t){},"85ec":function(e,t,n){},9:function(e,t){}});
//# sourceMappingURL=app.78d31666.js.map