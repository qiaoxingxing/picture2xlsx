(function(e){function t(t){for(var r,i,c=t[0],u=t[1],l=t[2],d=0,s=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&s.push(o[i][0]),o[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);f&&f(t);while(s.length)s.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,c=1;c<n.length;c++){var u=n[c];0!==o[u]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={app:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var f=u;a.push([1,"chunk-vendors"]),n()})({0:function(e,t){},"034f":function(e,t,n){"use strict";var r=n("85ec"),o=n.n(r);o.a},1:function(e,t,n){e.exports=n("56d7")},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},15:function(e,t){},16:function(e,t){},17:function(e,t){},18:function(e,t){},2:function(e,t){},"22f2":function(e,t,n){e.exports=n.p+"img/downloadxls.3e960483.jpg"},3:function(e,t){},4:function(e,t){},"40a3":function(e,t,n){e.exports=n.p+"img/upload.7b9e71a3.jpg"},5:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("p",[e._v("1. 选择图片")]),r("img",{attrs:{alt:"image",src:n("40a3"),id:"img"},on:{click:e.uploadImage}}),r("p",[e._v("2.下载XLSX")]),r("img",{attrs:{alt:"image",src:n("22f2"),id:"download"},on:{click:e.downloadXlsx}}),r("p"),r("input",{staticStyle:{display:"none"},attrs:{type:"file",name:"file",accept:"image/*",id:"file"},on:{change:e.fileChange}}),e._m(0)])},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"comment"}},[n("br"),n("br"),n("p",[e._v("几点说明")]),n("ul",[n("li",[e._v("图片不会被上传到网络")]),n("li",[e._v("转换后的xlsx大小限制在200*200以下")]),n("li",[e._v("源码地址: "),n("a",{attrs:{href:"https://gitee.com/qiaoxingxing/picture2xlsx"}},[e._v("gitee")]),e._v(" "),n("a",{attrs:{href:"https://github.com/qiaoxingxing/picture2xlsx"}},[e._v("github")])])])])}],i=(n("c975"),n("cb29"),n("c19f"),n("d3b7"),n("25f0"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("2909")),c=n("1146"),u=n.n(c),l=n("1088"),f=n.n(l),d=n("21a6"),s=function(e,t,n){var r=t*(4*n)+4*e;return[r,r+1,r+2,r+3]},p=function(e,t,n){var r=s(e,t,n.width),o=n.data;return[o[r[0]],o[r[1]],o[r[2]],o[r[3]]]};function g(e){var t=e.toString(16);return 1==t.length?"0"+t:t}var h=function(e,t,n){return g(e)+g(t)+g(n)};function v(e){var t=e.width,n=e.height,r=u.a.utils.book_new(),o=u.a.utils.aoa_to_sheet([]);u.a.utils.book_append_sheet(r,o,"sheet_name");for(var a=20,c=[{wpx:a}],l=0;l<t;l++)c.push(c[0]);o["!cols"]=c;for(var s=a,g=[{hpx:s}],v=0;v<n;v++)g.push(g[0]);o["!rows "]=g;var b=new Array(t).fill(""),y=new Array(n).fill(b);u.a.utils.sheet_add_aoa(o,y,{origin:"A1"});for(var w=0;w<n;w++)for(var x=w,_=0;_<t;_++){var j=_,O=u.a.utils.encode_cell({c:_,r:w}),k=o[O],S=p(j,x,e),I=h.apply(void 0,Object(i["a"])(S));k.s={fill:{fgColor:{rgb:I}}}}var A={bookType:"xlsx",bookSST:!1,type:"binary"},E=f.a.write(r,A);Object(d["saveAs"])(new Blob([m(E)],{type:""}),"out.xlsx"),console.debug("done")}function m(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}var b={download:v},y={name:"App",data:function(){return{}},methods:{test:function(){},downloadXlsx:function(){var e=this,t=this.$loading({lock:!0,text:"处理中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout((function(){try{var n=document.getElementById("img"),r=document.createElement("canvas"),o=e.getScale(n.width,n.height),a=n.width*o,i=n.height*o;r.width=a,r.height=i;var c=r.getContext("2d");c.drawImage(n,0,0,a,i);var u=c.getImageData(0,0,a,i);console.debug("imageData",u),b.download(u),t.close()}catch(l){t.close(),console.debug("error",l),e.$message.error("出现错误")}}),100)},getScale:function(e,t){var n=200,r=Math.max(e,t);return r>n?n/r:1},uploadImage:function(){document.getElementById("file").click()},fileChange:function(){this.loadImage()},loadImage:function(){try{if(document.getElementById("file").files.length<0)return;var e=document.getElementById("file").files[0],t=e.type;if(t=t.substring(0,t.indexOf("/")),"image"!=t)return void this.$message.error("请选择一个jpg|gif|png 格式图片");var n=new FileReader;n.onload=function(e){var t=e.target.result;document.getElementById("img").src=t},n.readAsDataURL(e)}catch(r){console.log(r)}}}},w=y,x=(n("034f"),n("2877")),_=Object(x["a"])(w,o,a,!1,null,null,null),j=_.exports,O=n("5c96");n("0fae");r["default"].use(O["Loading"].directive),r["default"].prototype.$loading=O["Loading"].service,r["default"].prototype.$message=O["Message"],r["default"].config.productionTip=!1,new r["default"]({render:function(e){return e(j)}}).$mount("#app")},6:function(e,t){},7:function(e,t){},8:function(e,t){},"85ec":function(e,t,n){},9:function(e,t){}});
//# sourceMappingURL=app.9f76b371.js.map